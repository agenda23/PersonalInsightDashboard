# Twelve Data 無料プラン制限事項

## 🚨 重要な制限

Twelve Data APIの**Basic（無料）プラン**には以下の制限があります：

### ❌ 利用できないデータ

#### 1. 日経平均株価（N225）
```
エラー: symbol or figi parameter is missing or invalid
```
- **理由**: 日本の株価指数は無料プランで非対応
- **代替案**: モックデータを使用（アプリ内で自動対応済み）

#### 2. S&P 500指数（SPX）
```
エラー: This symbol is available starting with Grow plan
```
- **理由**: 米国の主要指数はGrowプラン（有料）以上が必要
- **代替案**: モックデータを使用（アプリ内で自動対応済み）

### ✅ 利用できるデータ（Basic無料プラン）

#### Forex（為替）
- ✅ USD/JPY - 米ドル/日本円
- ✅ EUR/USD - ユーロ/米ドル
- ✅ GBP/USD - 英ポンド/米ドル
- ✅ その他主要通貨ペア

#### Crypto（暗号資産）
- ✅ BTC/USD - ビットコイン
- ✅ ETH/USD - イーサリアム
- ✅ その他主要暗号資産

#### Stocks（米国株式のみ）
- ✅ AAPL - Apple Inc.
- ✅ TSLA - Tesla Inc.
- ✅ MSFT - Microsoft
- ✅ その他米国株（遅延データ）

#### ⚠️ 注意点
- **米国株は15分遅延データ**
- **リアルタイムデータは有料プラン**

---

## 📊 プラン比較

### Basic（無料プラン）
- 📍 **800 API calls/day**
- 📍 **8 API calls/minute**
- ✅ Forex（為替）
- ✅ Crypto（暗号資産）
- ✅ 米国株式（遅延）
- ❌ 日本株式
- ❌ 主要指数（S&P 500, NASDAQ等）
- ❌ リアルタイムデータ

**月額**: $0（無料）

### Grow（成長プラン）
- 📍 **8,000 API calls/day**
- 📍 **30 API calls/minute**
- ✅ 全てのBasic機能
- ✅ **主要指数（S&P 500, NASDAQ等）**
- ✅ リアルタイムデータ
- ✅ 延長時間外データ
- ❌ 日本株式

**月額**: $29〜（年間契約で割引あり）

### Pro（プロフェッショナルプラン）
- 📍 **無制限API calls**
- 📍 **高速レート**
- ✅ 全てのGrow機能
- ✅ **日本株式を含む全世界の株式**
- ✅ WebSocket対応
- ✅ バッチリクエスト
- ✅ 高度なテクニカル指標

**月額**: $79〜（年間契約で割引あり）

詳細: [https://twelvedata.com/pricing](https://twelvedata.com/pricing)

---

## 💡 当アプリでの対応状況

### ✅ 実装済みの対策

#### 1. 自動フォールバック機能
エラーが発生した場合、自動的にモックデータにフォールバック：

```javascript
// N225（日経平均）が取得できない場合
{
  value: 33486,      // 模擬値
  change: 125,
  changePercent: 0.37
}

// SPX（S&P 500）が取得できない場合
{
  value: 4567,       // 模擬値
  change: 23,
  changePercent: 0.51
}
```

#### 2. わかりやすいコンソールメッセージ
```
⚠️ 日経平均（N225）: Twelve Data無料プランでは利用できません。
   モックデータを表示します。

⚠️ S&P 500（SPX）: Twelve Data無料プランでは利用できません
   （Growプラン以上が必要）。モックデータを表示します。
```

#### 3. APIキー未設定時の警告UI
ダッシュボードに黄色の警告ボックスを表示：
- APIキーが未設定であることを通知
- モックデータであることを明示
- 設定画面への誘導ボタン

---

## 🎯 推奨される使用方法

### オプション1: モックデータモード（推奨）

**最もシンプルで問題のない方法**

1. APIキーを設定しない（または削除する）
2. すべてのデータがモックデータとして表示される
3. アプリの全機能を試すことができる

**メリット**:
- ✅ API制限の心配なし
- ✅ すべての市場データが表示される
- ✅ デモンストレーション用として最適
- ✅ 追加コストなし

**デメリット**:
- ❌ 実際のデータは取得できない
- ❌ データは固定値

### オプション2: 部分的なリアルデータ使用

**無料プランで取得可能なデータのみ実データを使用**

1. 無料のAPIキーを取得して設定
2. USD/JPYとBTC/USDは実データが取得される
3. N225とSPXは自動的にモックデータにフォールバック

**メリット**:
- ✅ 為替と暗号資産は実データ
- ✅ 無料で使用可能

**デメリット**:
- ❌ API制限あり（800回/日）
- ❌ 株価指数はモックデータのまま

### オプション3: 有料プランにアップグレード

**すべてのデータをリアルタイムで取得**

1. Grow以上のプランに加入（$29/月〜）
2. S&P 500が実データで取得可能に
3. リアルタイムデータが利用可能

**メリット**:
- ✅ S&P 500の実データ取得
- ✅ リアルタイムデータ
- ✅ API制限が緩和

**デメリット**:
- ❌ 月額料金が発生
- ❌ 日本株（N225）はProプラン必要

---

## 🔄 代替APIサービス

### Alpha Vantage（推奨代替）

**無料プラン**:
- 500 requests/day
- 5 requests/minute
- **日本株対応**
- リアルタイムデータ

**URL**: [https://www.alphavantage.co/](https://www.alphavantage.co/)

**長所**:
- ✅ 日本株が無料で取得可能
- ✅ 設定が簡単

**短所**:
- ❌ Twelve Dataより制限が厳しい

### Yahoo Finance API（非公式）

**完全無料**:
- レート制限が緩い
- 日本株対応
- リアルタイムデータ

**注意**:
- ⚠️ 非公式API
- ⚠️ 将来の可用性不確定

---

## 📝 まとめ

### 現在の状態
✅ **アプリは正常に動作しています**

エラーメッセージは出ていますが：
- モックデータへの自動フォールバックが機能
- ユーザーはすべてのウィジェットを閲覧可能
- データは表示され続けている

### 推奨アクション

#### 今すぐできること
1. **コンソールのエラーは無視してOK**
   - モックデータが正常に表示されている
   - アプリの機能は損なわれていない

2. **APIキーを削除してモックモードで使用**（推奨）
   - 設定画面でAPIキーを空にする
   - すべてのエラーメッセージが消える
   - モックデータが明示的に表示される

#### 長期的な選択肢
1. **モックデータモードで継続使用**（無料）
2. **Alpha Vantage APIに切り替え**（無料、日本株対応）
3. **Twelve Data有料プランに加入**（$29/月〜）

---

**最終更新**: 2025年10月8日
**バージョン**: 2.1.2

